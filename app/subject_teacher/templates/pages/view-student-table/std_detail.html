{% extends 'layouts/subject_teacherMain.html' %}
{% block title %} Student Management System {% endblock title %}
<!-- Specific CSS goes HERE -->
{% block stylesheets %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/css/bootstrap-datepicker.css"
    type="text/css" />
<link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/css/bootstrap-datepicker.css"
    type="text/css" />
<link href="../static/vendor/formValidation/tachyons.min.css" type="text/css" rel="stylesheet" />
<link href="../static/vendor/formValidation/formValidation.min.css" type="text/css" rel="stylesheet" />
{% endblock stylesheets %}
{% block content %}
<div class="main-panel">
    <div class="content-wrapper">
        <div class="row">
            <div class="col-12 grid-margin stretch-card">
                <div class="card">
                    <div class="card-body">
                        <h4 class="card-title">Evaluate Student</h4>
                        <hr>
                        <div class="pos-rel">
                            <!-- Nav pills -->
                            <ul class="nav nav-pills justify-content-center nav-justified" role="tablist">
                                <li class="nav-item">
                                    <hr class="horizontal1" />
                                    <a class="nav-link active btn btn-primary" data-toggle="pill"
                                        href="#studentDetail">Student Detail</a>
                                </li>
                                <li class="nav-item">
                                    <hr class="horizontal1" />
                                    <a class="nav-link btn btn-primary" data-toggle="pill" href="#marks_std">Enter
                                        Marks</a>
                                <li class="nav-item">
                                    <a class="nav-link btn btn-primary" data-toggle="pill" href="#marks_view">View
                                        Marks</a>
                                </li>
                                </li>

                            </ul>
                            <div class="connected-line"></div>
                            <!-- Tab panes -->
                            <div class="tab-content">
                                <div id="studentDetail" class="container tab-pane active">
                                    <div class="container mt-0">
                                        <div class="row d-flex justify-content-center">
                                            <div class="col-md-7">
                                                <div class="card p-3 py-1">
                                                    <div class="text-center">
                                                        <a href="{{ std.half_photo }}" class="image-popup"
                                                            title="Passport Size Photo">
                                                            <img src="{{ std.half_photo }}" width="150px"
                                                                height="140px" class="rounded-circle">
                                                        </a>
                                                        <p>Student Photo</p>
                                                    </div>
                                                    <div class="text-center mt-3">
                                                        <span class="bg-secondary p-1 px-4 rounded text-white">
                                                            {{std.first_name}}
                                                            {{std.last_name}}</span>
                                                        <div class="px-4 mt-1"> <br>
                                                            <p><b>Student CID:</b> {{std.student_cid}}</p>
                                                            <p><b>Index Number:</b> {{std.index_number}}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <div id="marks_std" class="container tab-pane fade">
                                    <form action="#" method="#" id="info">
                                        <input type="hidden" name="sub_id" value="{{current_user.id}}">
                                        <input type="hidden" name="std_id" value="{{std.id}}">

                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group row">
                                                    <label for="class_test"
                                                        class="control-label col-sm-4 text-right">Class
                                                        Test
                                                        01:</label>
                                                    <div class="col-sm-8">
                                                        <input type="text" class="form-control"
                                                            placeholder="Enter Marks *" name="class_test_1" value="" />
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    <label for="class_test"
                                                        class="control-label col-sm-4 text-right">CA:</label>
                                                    <div class="col-sm-8">
                                                        <input type="text" class="form-control" placeholder="Enter CA *"
                                                            name="CA" value="" />
                                                    </div>

                                                </div>
                                                <div class="form-group row">
                                                    <label for="class_test"
                                                        class="control-label col-sm-4 text-right">Class
                                                        Test
                                                        02:</label>
                                                    <div class="col-sm-8">
                                                        <input type="text" class="form-control"
                                                            placeholder="Enter Marks *" name="class_test_2" value="" />
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group row">
                                                    <label for="fname"
                                                        class="control-label col-sm-4 text-right">Mid-Term
                                                        Marks:</label>
                                                    <div class="col-sm-8">
                                                        <input type="text" class="form-control"
                                                            placeholder="Mid-term marks *" name="mid_term" value="" />
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    <label for="fname" class="control-label col-sm-4 text-right">Annual
                                                        Exam:</label>
                                                    <div class="col-sm-8">
                                                        <input type="text" class="form-control"
                                                            placeholder="Annual Exam Marks *" name="annual_exam"
                                                            value="" />
                                                    </div>
                                                </div>
                                                <div class="form-group row">
                                                    <label for="std_status"
                                                        class="control-label col-sm-4 text-right">Status:</label>
                                                    <div class="col-sm-8">
                                                        <select name="std_status" id="std_status" class="form-control">
                                                            <option value="">---Select Status---</option>
                                                            <option value="PASS">PASS</option>
                                                            <option value="FAIL">FAIL</option>
                                                        </select>
                                                    </div>

                                                </div>
                                            </div>
                                            <hr>
                                            <div class="row" id="subjectTeacher_div" style="display: none;">
                                                <h4 class="card-title">Student Remarks</h4>
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="control-label col-sm-4 text-right"
                                                            for="punctuality">Punctuality:</label>
                                                        <div class="col-sm-8">
                                                            <select name="punctuality" id="punctuality"
                                                                class="form-control">
                                                                <option value="">---Select---</option>
                                                                <option value="Outstanding">Outstanding</option>
                                                                <option value="Very Good">Very Good</option>
                                                                <option value="Good">Good</option>
                                                                <option value="Satisfactory">Satisfactory
                                                                </option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="form-group row">
                                                        <label class="control-label col-sm-4 text-right"
                                                            for="discipline">Discipline:</label>
                                                        <div class="col-sm-8">
                                                            <select name="discipline" id="discipline"
                                                                class="form-control">
                                                                <option value="">---Select---</option>
                                                                <option value="Outstanding">Outstanding</option>
                                                                <option value="Very Good">Very Good</option>
                                                                <option value="Good">Good</option>
                                                                <option value="Satisfactory">Satisfactory
                                                                </option>

                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-md-6">
                                                    <div class="form-group row">
                                                        <label class="control-label col-sm-4 text-right"
                                                            for="socialservice">Social Service:</label>
                                                        <div class="col-sm-8">
                                                            <select name="socialservice" id="socialservice"
                                                                class="form-control">
                                                                <option value="">---Select---</option>
                                                                <option value="Outstanding">Outstanding</option>
                                                                <option value="Very Good">Very Good</option>
                                                                <option value="Good">Good</option>
                                                                <option value="Satisfactory">Satisfactory
                                                                </option>

                                                            </select>
                                                        </div>
                                                    </div>

                                                    <div class="form-group row">
                                                        <label class="control-label col-sm-4 text-right"
                                                            for="leadership">Leadership Quality:</label>
                                                        <div class="col-sm-8">
                                                            <select name="leadership" id="leadership"
                                                                class="form-control">
                                                                <option value="">---Select---</option>
                                                                <option value="Outstanding">Outstanding</option>
                                                                <option value="Very Good">Very Good</option>
                                                                <option value="Good">Good</option>
                                                                <option value="Satisfactory">Satisfactory
                                                                </option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="button-center text-center">
                                            <button type="submit" id="sub_sent" class="btn btn-sm btn-warning"
                                                style="color: white; width: 101px; height: 40px; font-size: 16px;">Submit</button>
                                        </div>
                                    </form>
                                </div>


                                <!-- table -->
                                <div id="marks_view" class="container tab-pane fade">
                                    <div class="card-body">
                                        <div class="row">
                                            <div class="table-responsive">
                                                <table class="table align-items-center table-flush" id="customerList"
                                                    style="width:100%;">
                                                    <thead class="thead-light">
                                                        <tr>
                                                            <th scope="col" class="sort" data-sort="name">Subject
                                                            </th>
                                                            <th scope="col" class="sort" data-sort="name">class test
                                                                I
                                                            </th>
                                                            <th scope="col" class="sort" data-sort="budget">Mid-term
                                                                Exam</th>
                                                            <th scope="col" class="sort" data-sort="name">Class test
                                                                II
                                                            </th>
                                                            <th scope="col" class="sort" data-sort="name">Annual
                                                                Exam
                                                            </th>
                                                            <th scope="col" class="sort" data-sort="name">CA</th>
                                                            <th scope="col" class="sort" data-sort="name">Total</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="list">

                                                        {% for usr in user %}

                                                        <tr>
                                                            <th scope="row">
                                                                {{ usr.subject }}
                                                            </th>
                                                            <th scope="row">
                                                                {{ usr.class_test_one }}
                                                            </th>
                                                            <td class="budget">
                                                                {{ usr.mid_term}}
                                                            </td>
                                                            <td class="budget">
                                                                {{ usr.class_test_two}}
                                                            </td>
                                                            <td class="budget">
                                                                {{ usr.annual_exam }}
                                                            </td>
                                                            <td class="budget">
                                                                {{ usr.cont_assessment }}
                                                            </td>
                                                            <td class="budget">
                                                                {{ usr.total }}
                                                            </td>

                                                        </tr>
                                                        {% endfor %}
                                                    </tbody>
                                                </table>
                                                <hr>
                                                <h5>Student Remarks :</h5> <br>
                                                <table class="table table-bordered">
                                                    <thead>
                                                        <tr>
                                                            <th>sl</th>
                                                            <th>Personal Qualities</th>
                                                            <th>Rating</th>
                                                        </tr>
                                                    </thead>
                                                    <tbody>
                                                        <tr>
                                                            <td>1</td>
                                                            <td>Punctuality</td>
                                                            <td>{{std.punctuality}}</td>
                                                            
                                                        </tr>
                                                        <tr>
                                                            <td>2</td>
                                                            <td>Discipline</td>
                                                            <td>{{std.discipline}}</td>
                                                        </tr>
                                                        <tr>
                                                            <td>3</td>
                                                            <td>Social Service</td>
                                                            <td>{{std.social_service}}</td>
                                                        </tr> 
                                                        <tr>
                                                            <td>4</td>
                                                            <td>Leadership Quality</td>
                                                            <td>{{std.leadership_quality}}</td>
                                                            
                                                        </tr>                                       
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- end table -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock content %}
<!-- Specific JS goes HERE -->
{% block javascripts %}

<script src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
<script src="../static/vendor/formValidation/es6-shim.min.js"></script>
<script src="../static/vendor/formValidation/formValidation.min.js"></script>
<script src="../static/vendor/formValidation/Bootstrap.min.js"></script>
<script src="../static/vendor/formValidation/Tachyons.min.js"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script src="../static/js/mark_submission.js"></script>
<script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>

<script>
    function std_detail_validation() {
        var form = document.getElementById("info");
        var data = new FormData(form);
        $.ajax({
            type: 'POST',
            url: '/store-std-marks',
            data: data,
            processData: false,
            contentType: false,
            cache: false,

            success: function (res) {
                if (res === 'Error') {
                    swal("Data already exist", "Infomation submission failed", "error")
                        .then(function () {
                            window.location = ""
                        });
                } else {
                    swal("Marks successfully updated", "Click Ok to continue", "success")
                        .then(function () {
                            windows.location.href = "#marks_view"
                        })
                }
            }
        });
    };


    $("#std_status").on("change", function () {
        let status = $("#std_status").val();
        if (status === "PASS" || status === "FAIL") {
            $("#subjectTeacher_div").show();
        } else {
            $("#subjectTeacher_div").hide();
        }
    });


    // table
    $(document).ready(function () {
        loadUsers()
    });
    function loadUsers() {
        $('#customerList').DataTable({
            'processing': true,
            'serverSide': true,
            'bDestroy': true,
            'serverMethod': 'POST',
            'ajax': {
                'url': '/get-std-grade'
            },
            'columns': [
                { data: 'subject' },
                { data: 'class_test_one' },
                { data: 'mid_term' },
                { data: 'class_test_two' },
                { data: 'annual_exam' },
                { data: 'cont_assessment' },
                { data: 'total' },
            ],
            language: {
                paginate: {
                    next: '&#8594;', // or '→'
                    previous: '&#8592;' // or '←'
                }
            },
            "ordering": false
        });
    }

</script>
{% endblock javascripts %}