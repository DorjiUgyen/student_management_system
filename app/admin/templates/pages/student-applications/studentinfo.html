{% extends 'layouts/admin_main.html' %}

{% block title %} Student Management System {% endblock title %}
<!-- Specific CSS goes HERE -->
{% block stylesheets %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
<link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/css/bootstrap-datepicker.css"
    type="text/css" />
<link rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datepicker/1.6.4/css/bootstrap-datepicker.css"
    type="text/css" />
{% endblock stylesheets %}
{% block content %}
<div class="main-panel">
    <div class="content-wrapper">
        <div class="row">
            <div class="container-fluid">
            <div class="row">
              <div class="col-sm-12">
                <div class="pos-rel">
                  <!-- Nav pills -->
                  <ul class="nav nav-pills justify-content-center nav-justified" role="tablist">
                     <li class="nav-item">
                        <a class="nav-link active btn btn-primary" data-toggle="pill" href="#studentDetail">Student Detail</a>
                     </li>
                     <li class="nav-item">
                        <a class="nav-link btn btn-primary" data-toggle="pill" href="#academicDetail">Academic Detail</a>
                        <li class="nav-item">
                            <a class="nav-link btn btn-primary" data-toggle="pill" href="#parent-detail">Parents Detail</a>
                         </li>
                     </li>
                     <li class="nav-item">
                        <a class="nav-link btn btn-primary" data-toggle="pill" href="#actions">Action</a>
                     </li>
                  </ul>
                  <div class="connected-line"></div>
                  <!-- Tab panes -->
                  <div class="tab-content">
                     <div id="studentDetail" class="container tab-pane active">
                      <!-- forst display -->
                        <form method="POST" id="update_form" class="seminor-login-form" action="" enctype="multipart/form-data">
                            
                            <!-- student's detail -->
                            <div class="student">
<<<<<<< HEAD
                                <div class="container mt-3">
                                    <div class="row d-flex justify-content-center"> 
                                        <div class="col-md-3"> 
                                            <div class="card p-3 py-1">     
                                                <div class="text-center">
                                                    <a href="{{ std.half_photo }}" class="image-popup" title="Passport Size Photo">
                                                        <img src="{{ std.half_photo }}" width="150px" height="130px" class="rounded-circle">
                                                    </a>
                                                </div>
                                            </div> 
                                        </div>
                                    </div>  
                                </div> <hr>
                                
                                <div class="row ">
                                    <div class="col-md-4 form-group row">
                                        <label for="cid" class="control-label col-md-4">CID:</label>
                                        <div class="col-md-4">
                                        <input type="text" class="form-control" value="{{std.student_cid}}" name="cid"
                                            id="cid" disabled>
                                            </div>
                                    </div>
                                    <div class="col-sm-4 form-group">
                                        <label>First Name:</label>
                                        <input type="text" class="form-control" value="{{std.first_name}}"
                                            name="first_name" id="first_name" disabled>
=======
                                    <div class="row">
                                        <div class="col-md-4 col-lg-4">
                                            <div class="gal-detail thumb ">
                                                <h5>Passport Size Photo</h5>
                                                <a href="{{ std.half_photo }}" class="image-popup"
                                                    title="Passport Size Photo">
                                                    <img src="{{ std.half_photo }}" class="thumb-img-mark" width="200"
                                                        height="150" alt="Passport Size Image">
                                                </a>

                                            </div>
                                        </div>

>>>>>>> 7b2d246e272999b2d0fd57738ac38fc631e7dd34
                                    </div>
                                    <hr>
                                    <div class="row ">
                                        <div class="col-sm-4 form-group">
                                            <label for="cid">CID:</label>
                                            <input type="text" class="form-control" value="{{std.student_cid}}" name="cid"
                                                id="cid" disabled>
                                        </div>
                                        <div class="col-sm-4 form-group">
                                            <label>First Name:</label>
                                            <input type="text" class="form-control" value="{{std.first_name}}"
                                                name="first_name" id="first_name" disabled>
                                        </div>

                                        <div class="col-sm-4 form-group">
                                            <label>Last Name:</label>
                                            <input type="text" value="{{std.last_name}}" class="form-control"
                                                name="last_name" id="last_name" disabled>
                                        </div>
                                    </div>

                                    <div class="row ">
                                        <div class="col-sm-4 form-group">
                                            <label>Gender:</label>
                                            <input type="text" class="form-control" value="{{std.gender}}" name="gender"
                                                id="gender" disabled>
                                        </div>
                                        <div class="col-sm-4 form-group">
                                            <label>Date of Birth:</label>
                                            <input type="text" class="form-control" value="{{std.dob}}" name="dob" id="dob"
                                                disabled>
                                        </div>

                                        <div class="col-sm-4 form-group">
                                            <label>Email Address:</label>
                                            <input type="text" value="{{std.student_email}}" class="form-control"
                                                name="email_add" id="email_add" disabled>
                                        </div>
                                    </div>

                                    <div class="row ">
                                        <div class="col-sm-4 form-group">
                                            <label>Dzongkhag:</label>
                                            <input type="text" class="form-control" value="{{std_info.dzo_name}}"
                                                name="per_dzongkhag" id="per_dzongkhag" disabled>
                                        </div>
                                        <div class="col-sm-4 form-group">
                                            <label>Gewog:</label>
                                            <input type="text" class="form-control" value="{{std_info.gewog_name}}"
                                                name="per_gewog" id="per_gewog" disabled>
                                        </div>

                                        <div class="col-sm-4 form-group">
                                            <label>Village:</label>
                                            <input type="text" value="{{std_info.village_name}}" class="form-control"
                                                name="per_village" id="per_village" disabled>
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-sm-4 form-group">
                                            <label>Phone Number:</label>
                                            <input type="text" value="{{std.student_phone_number}}" class="form-control"
                                                name="phone_num" id="phone_num" disabled>

                                        </div>
                                    </div>
                            </div>
                                <div class=" p-1 mb-2 mt-3 bg-secondary" style="font-weight: 500; font-size: 13px; color: white;">Present Address Detail</div>
                                <div class="row">
                                    <div class="col-sm-4 form-group">
                                        <label>Dzongkhag:</label>
                                        <input type="text" class="form-control" value="{{std.dzo_name}}" name="pre_dzongkhag"
                                            id="pre_dzongkhag" disabled>
                                    </div>

                                    <div class="col-sm-4 form-group">
                                        <label>Gewog:</label>
                                        <input type="text" value="{{std.gewog_name}}" class="form-control"
                                            name="per_gewog" id="per_gewog" disabled>
                                    </div>
                                    <div class="col-sm-4 form-group">
                                        <label>Village:</label>
                                        <input type="text" value="{{std.village_name}}" class="form-control"
                                            name="per_village" id="per_village" disabled>
                                    </div> 
                                </div>
                            </div>
                        
                            <div id="academicDetail" class="container tab-pane fade">
                            <!-- second display -->
                                <div class="academic">
                                    <div class="row ">
                                        <div class="col-sm-4 form-group">
                                            <label>Index Number:</label>
                                            <input type="text" class="form-control" value="{{std.index_number}}"
                                                name="index_num" id="index_num" disabled>
                                        </div>
                                        <div class="col-sm-4 form-group" {% if(std.student_code=='' ) %} hidden {% endif %}>
                                            <label>Student Code:</label>
                                            <input type="text" class="form-control" value="{{std.student_code}}"
                                                name="std_code" id="std_code" disabled>
                                        </div>

                                        <div class="col-sm-4 form-group" {% if(std.bcse_x=='' ) %} hidden {% endif %}>
                                            <label>BCSE (Class X):</label>
                                            <input type="text" value="{{std.bcse_x}}" class="form-control" name="class_x"
                                                id="class_x" disabled>
                                        </div>

                                        <div class="col-sm-4 form-group" {% if(std.bhsec_xii=='' ) %} hidden {% endif %}>
                                            <label>BHSEC (Class XII):</label>
                                            <input type="text" class="form-control" value="{{std.bhsec_xii}}"
                                                name="class_XII" id="class_XII" disabled>
                                        </div>
                                        <div class="col-sm-4 form-group">
                                            <label>Accommodation (if admitted):</label>
                                            <input type="text" class="form-control" value="{{std.accommodation}}"
                                                name="accommodation" id="accommodation" disabled>
                                        </div>

                                        <div class="col-sm-4 form-group">
                                            <label>Admission for? (Enter class):</label>
                                            <input type="text" value="{{std.admission_for_class}}" class="form-control"
                                                name="admission" id="admission" disabled>
                                        </div>


                                        <div class="col-sm-4 form-group" {% if(std.previous_school_name=='' ) %} hidden {%
                                            endif %}>
                                            <label>Previous School:</label>
                                            <input type="text" class="form-control" value="{{std.previous_school_name}}"
                                                name="previous_school" id="previous_school" disabled>
                                        </div>
                                        <div class="col-sm-4 form-group" {% if(std.stream==None ) %} hidden {% endif %}>
                                            <label>Stream:</label>
                                            <input type="text" class="form-control" value="{{std.stream}}" name="stream"
                                                id="stream" disabled>
                                        </div>

                                        <div class="col-sm-4 form-group">
                                            <label>SUPW Grade:</label>
                                            <input type="text" value="{{std.supw_grade}}" class="form-control" name="supw"
                                                id="supw" disabled>
                                        </div>
                                        <div class="col-sm-4 form-group">
                                            <label>Percentage:</label>
                                            <input type="text" value="{{std.percentage_obtained}}%" class="form-control"
                                                name="percentage" id="percentage" disabled>
                                        </div>
                                    </div>

                                    <div class="col-md-4 col-lg-4">
                                        <div class="gal-detail thumb ">
                                            <h5>Marksheet</h5>
                                            <a href="{{ std.marksheet }}" class="image-popup" title="marksheet Photo">
                                                <img src="{{ std.marksheet }}" class="thumb-img-mark" width="400"
                                                    height="550" alt="Marksheet Image">
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div id="parent-detail" class="container tab-pane fade">
                            <!-- third display -->
                                    <div class="row">
                                        <div class="col-sm-4 form-group">
                                            <label>CID:</label>
                                            <input type="text" class="form-control" value="{{std.parent_cid}}" name="par_cid"
                                                id="par_cid" disabled>
                                        </div>

                                        <div class="col-sm-4 form-group">
                                            <label>Parent Name:</label>
                                            <input type="text" value="{{std.parent_full_name}}" class="form-control"
                                                name="par_name" id="par_name" disabled>
                                        </div>
                                        <div class="col-sm-4 form-group">
                                            <label>Phone Number:</label>
                                            <input type="text" value="{{std.parent_contact_number}}" class="form-control"
                                                name="par_number" id="par_number" disabled>
                                        </div>

                                        <div class="col-sm-4 form-group">
                                            <label>Email Address:</label>
                                            <input type="text" value="{{std.parent_email}}" class="form-control"
                                                name="par_email" id="par_email" disabled>
                                        </div>

                                    </div>
                            </div>
                            <div id="actions" class="container tab-pane fade">
                                <!-- final display -->
                                <div class="row">
                                    <input type="hidden" name="email" value="{{ std.student_email }}">
                                    <input type="hidden" name="name" value="{{ std.first_name }}">
                                    <input type="hidden" name="app_id" value="{{std.id}}">
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-control-label col-form-label" for="action">Action</label>
                                            <select name="action" id="action" class="form-control form-control-sm">
                                                <option value="">Select Action</option>
                                                <option value="approved">Approved Application</option>
                                                <option value="reject For Amendment">Reject For Amendment</option>
                                                <option value="returned">Reject Application</option>
                                            </select>
                                            <span class="invalid-feedback">Please select action type</span>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="form-group">
                                            <label class="form-control-label col-form-label" for="">Narration</label>
                                            <textarea name="narration" class="form-control form-control-sm"></textarea>
                                        </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12">
                                        <button type="button" id="update" class="btn btn-md btn-primary">Submit</button>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                   </div>
               </div>
            </div>
        </div>
    </div>
    </div>
</div>
                        


{% endblock content %}

<!-- Specific JS goes HERE -->
{% block javascripts %}
<script src="https://code.jquery.com/jquery-3.3.1.min.js"
    integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
    crossorigin="anonymous"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script>
    $("#action").on('change', function () {
        if (this.value == '') {
            $("#action").addClass('is-invalid')
        } else {
            $("#action").removeClass('is-invalid')
            $("#action").addClass('is-valid')
        }
    });

    $("#update").on('click', function () {
        if ($("#action").val() == '') {
            $("#action").addClass('is-invalid')
        } else {
            var form_data = new FormData($('#update_form')[0])
            $.ajax({
                type: "POST",
                url: "/update-status",
                data: form_data,
                dataType: "json",
                contentType: false,
                cache: false,
                processData: false,
                beforeSend: function () {
                    $("#update").text("Loading....")
                    $("#update").attr("disabled", true)
                    $("#update").addClass("disabled")

                },
                success: function (data) {
                    swal('Success', 'Application status updated successfully', 'success').then(function () {
                        window.location = '/admin-student-application-list'
                    })
                },
                error: function () {
                    swal('Success', 'Application status updated successfully', 'success').then(function () {
                        window.location = '/admin-student-application-list'
                    })
                }
            });
        }
    });
</script>

{% endblock javascripts %}